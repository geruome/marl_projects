pylance 

## 啤酒厂供应链管理
人为设定策略：
先满足下游，再从上游进货。

state: (上一时刻订单,供应量,当前库存). 只可见自己的 !!!
reward: 供应量 - 供不上 - 订单 - 当前库存管理费
离散问题, action_size=20:[1,20], 不能为0.

核心目标为满足下游order. 上游要了就有(很不合理...), 

训练中带gamma.实际目标不带。
gamma为1, Value iteration:
(1)收敛到V值两两之差固定。大小仍在变
(2)非就地(oop) / 就地(ip)正序 / 就地倒序 结果不同。

gamma < 1: 收敛性很棒 !!!


why gamma<1 大小不收敛 ???

非就地的best_act单调不降看起来很正常。

10000次test:
oop：464.22, 93.8%
gamma=0.99: 464.10, 93.9%
ip(正序)：461.22
ip(逆序)：461.61

DQN: 
0.01, 442.74
0.08, 446.56
0.10, 453.83
0.12, 438.19
0.15, 432.25

0.05: (2000,405.88) (2500,416.72) (3000,) (3500,416.98) (4000,)

非就地：
[18.058 19.906 21.595 23.119 24.473 25.654 26.687 27.546 28.229 28.749
 29.119 29.314 29.358 29.248 28.985 28.576 28.037 27.357 26.555 25.651
 24.651 23.651 22.651 21.651 20.651 19.651 18.651 17.651 16.568 15.4
 14.152 12.828 11.431  9.967  8.44   6.854  5.213  3.521  1.783  0.   ]
[16, 16, 16, 16, 16, 15, 15, 15, 15, 14, 14, 14, 13, 13, 12, 12, 11, 10, 9, 9, 8, 7, 6, 5, 4, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
gamma = 0.99:
[-56.067 -54.219 -52.53  -51.005 -49.649 -48.468 -47.439 -46.578 -45.891
 -45.373 -44.998 -44.798 -44.757 -44.861 -45.124 -45.526 -46.065 -46.746
 -47.544 -48.444 -49.444 -50.444 -51.444 -52.444 -53.444 -54.444 -55.444
 -56.444 -57.52  -58.679 -59.917 -61.231 -62.615 -64.065 -65.578 -67.148
 -68.772 -70.445 -72.164 -73.925]
[16, 16, 16, 16, 16, 16, 15, 15, 15, 14, 14, 14, 13, 13, 12, 12, 11, 10, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]


satisfied_demand不能很好反应下游需求。下游库存最重要。

没用 double-Q 缓解自举。